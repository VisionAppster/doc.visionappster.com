
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Dlib Integration &mdash; VisionAppster  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/docsearch.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../../_static/v.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script defer="defer" src="../../../_static/js/docsearch.min.js"></script>
        <script defer="defer" src="../../../_static/js/algolia.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="DlibImage" href="DlibImage/" />
    <link rel="prev" title="C++ API" href="../" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <div data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search" >
        

        
          <a href="../../../">
        

        
          
          <img src="../../../_static/visionappster.png" class="logo" alt="Logo">
        
        </a>

        
          
          
        

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <nav class="wy-nav-side-inner">
        <div class="wy-side-scroll">
          
          <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
              
              
                
              
              
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../engine/">Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../builder/">Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/">Built-in tools</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">APIs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../#data-types">Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../remoteio/">Remote I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tool/">Tool APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../c/">C API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../">C++ API</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Dlib Integration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="DlibImage/">DlibImage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../opencv/">OpenCV Integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../js/">JavaScript client API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/">Python API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../components/">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cameras/">Cameras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cookbook/">Cookbook</a></li>
</ul>

              
            
          </div>
          
        </div>
      </nav>
    </div>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../">VisionAppster</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../">APIs</a> &raquo;</li>
        
          <li><a href="../">C++ API</a> &raquo;</li>
        
      <li>Dlib Integration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dlib-integration">
<h1>Dlib Integration<a class="headerlink" href="#dlib-integration" title="Permalink to this headline">ðŸ”—</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>The Dlib integration API provides a <code class="docutils literal notranslate"><span class="pre">dlibImage</span></code> function that wraps
the VisionAppster image type (<code class="docutils literal notranslate"><span class="pre">va_image*</span></code>) to a Dlib-compatible
template class. It makes it possible to call Dlib functions from your
custom tool implementations without much boilerplate code.</p>
<p>Please see the <a class="reference internal" href="../../c/tool/"><span class="doc">tool C API</span></a> for general instructions on
how to set you your environment and build tool plugins. Since Dlib is
implemented in C++, it is important to understand compiler requirements.</p>
<p>The VisionAppster SDK comes with the source code of the built-in Dlib
plugin. To get started, have a look at <code class="docutils literal notranslate"><span class="pre">sdk/examples/dlib</span></code> under your
installation. Modify the supplied <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> to fit your setup. If you
installed everything to default locations, building your first Dlib
plugin on Linux can be as simple as this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> ~/VisionAppster/sdk/examples/dlib
make install
</pre></div>
</div>
<p>Windows (MinGW-w64), assuming you copied the SDK to your desktop folder:</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">cd</span> <span class="nv">%USERPROFILE%</span>\Desktop\sdk\examples\dlib
mingw32-make
<span class="p">:</span><span class="c1">: This may require admin rights.</span>
mingw32-make install
</pre></div>
</div>
<p>Windows (MinGW-w64 + MSYS2), assuming you copied the SDK to your desktop
folder:</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">cd</span> /c/Users/$USERNAME/Desktop/sdk/examples/dlib
make
# This may require admin rights.
make install
</pre></div>
</div>
<p>If you use Dlib to implement your own tools, you are strongly encouraged
to use the version that comes with the platform SDK. While it would be
technically possible to use multiple different versions of shared
libraries in a single process, it is not currently supported. If you
absolutely need a different version, you may link the required parts of
Dlib statically to your tool plugin.</p>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">ðŸ”—</a></h2>
<p>The following example shows a complete implementation of a plugin and a
tool that wraps the <code class="docutils literal notranslate"><span class="pre">dlib::min_barrier_distance</span></code> function. This is how
the built-in Minimum Barrier Distance tool is actually implemented.</p>
<p>The SDK that comes with the VisionAppster platform contains this and
other Dlib functions as examples. Please see the <code class="docutils literal notranslate"><span class="pre">sdk/examples/dlib</span></code>
directory in your installation.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;va_tool.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;va_all_types.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;DlibImage.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;dlib/image_transforms.h&gt;</span><span class="cp"></span>

<span class="n">VA_IMPLEMENT_PLUGIN</span><span class="p">(</span><span class="s">&quot;com.example.dlibtools&quot;</span><span class="p">,</span> <span class="mf">1.0.0</span><span class="p">)</span>

<span class="n">VA_REGISTER_TOOLS</span><span class="p">((</span><span class="n">IDENTIFIER</span><span class="p">(</span><span class="n">MinimumBarrierDistance</span><span class="p">),</span>
                   <span class="n">NAME</span><span class="p">(</span><span class="s">&quot;Minimum Barrier Distance&quot;</span><span class="p">),</span>
                   <span class="n">PROCESS</span><span class="p">(</span><span class="n">MinBarrierDistance_process</span><span class="p">),</span>
                   <span class="n">REQUIRED_INPUT</span><span class="p">(</span><span class="n">va_image</span><span class="p">,</span> <span class="n">image</span><span class="p">),</span>
                   <span class="n">OPTIONAL_INPUT</span><span class="p">(</span><span class="kt">int32_t</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                   <span class="n">OPTIONAL_INPUT</span><span class="p">(</span><span class="n">va_bool</span><span class="p">,</span> <span class="n">horizontalScan</span><span class="p">,</span> <span class="n">va_false</span><span class="p">),</span>
                   <span class="n">OUTPUT</span><span class="p">(</span><span class="n">va_image</span><span class="p">,</span> <span class="n">distance</span><span class="p">)))</span>

<span class="n">using</span> <span class="n">VisionAppster</span><span class="o">::</span><span class="n">dlibImage</span><span class="p">;</span>

<span class="c1">// The generic pattern for wrapping Dlib functions is to provide a</span>
<span class="c1">// functor template that can be applied to all supported image types.</span>
<span class="n">template</span> <span class="o">&lt;</span><span class="n">class</span> <span class="n">T</span><span class="o">&gt;</span>
<span class="k">struct</span> <span class="nc">DlibMinBarrierDistance</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="nf">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">va_image</span><span class="o">*</span> <span class="n">imgIn</span><span class="p">,</span>
                 <span class="n">va_image</span><span class="o">*</span> <span class="n">imgOut</span><span class="p">,</span>
                 <span class="kt">int32_t</span> <span class="n">iterations</span><span class="p">,</span>
                 <span class="kt">bool</span> <span class="n">leftRightScan</span><span class="p">)</span> <span class="k">const</span>
  <span class="p">{</span>
    <span class="n">dlib</span><span class="o">::</span><span class="n">min_barrier_distance</span><span class="p">(</span>
      <span class="n">dlibImage</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">imgIn</span><span class="p">),</span> <span class="c1">// Make va_image compatible with Dlib</span>
      <span class="n">dlibImage</span><span class="o">&lt;</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="o">&gt;</span><span class="p">(</span><span class="n">imgOut</span><span class="p">).</span><span class="n">ref</span><span class="p">(),</span> <span class="c1">// Modifiable reference</span>
      <span class="n">iterations</span><span class="p">,</span>
      <span class="n">leftRightScan</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">VA_SUCCESS</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="c1">// This is the entry point function from calls from the VisionAppster</span>
<span class="c1">// platform. The first argument is the tool instance, which are not</span>
<span class="c1">// using here. The second one holds function arguments.</span>
<span class="kt">int</span> <span class="nf">MinimumBarrierDistance_process</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">,</span> <span class="kt">void</span><span class="o">*</span> <span class="n">arguments</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">auto</span> <span class="n">args</span> <span class="o">=</span> <span class="n">reinterpret_cast</span><span class="o">&lt;</span><span class="n">MinimumBarrierDistance_args</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">arguments</span><span class="p">);</span>
  <span class="c1">// Initialize output image</span>
  <span class="n">args</span><span class="o">-&gt;</span><span class="n">out</span><span class="p">.</span><span class="n">distance</span> <span class="o">=</span> <span class="n">va_image_alloc_typed_copy</span><span class="p">(</span><span class="n">args</span><span class="o">-&gt;</span><span class="n">in</span><span class="p">.</span><span class="n">image</span><span class="p">,</span>
                                                 <span class="n">va_gray8_image_type</span><span class="p">);</span>
  <span class="c1">// The dlibCall function calls the functor template with the correct</span>
  <span class="c1">// template type.</span>
  <span class="k">return</span> <span class="n">dlibCall</span><span class="o">&lt;</span><span class="n">DlibMinBarrierDistance</span><span class="o">&gt;</span><span class="p">(</span>
    <span class="n">args</span><span class="o">-&gt;</span><span class="n">in</span><span class="p">.</span><span class="n">image</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">,</span>
    <span class="n">args</span><span class="o">-&gt;</span><span class="n">in</span><span class="p">.</span><span class="n">image</span><span class="p">,</span>
    <span class="n">args</span><span class="o">-&gt;</span><span class="n">out</span><span class="p">.</span><span class="n">distance</span><span class="p">,</span>
    <span class="n">args</span><span class="o">-&gt;</span><span class="n">in</span><span class="p">.</span><span class="n">iterations</span><span class="p">,</span>
    <span class="n">args</span><span class="o">-&gt;</span><span class="n">in</span><span class="p">.</span><span class="n">horizontalScan</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="DlibImage/" class="btn btn-neutral float-right" title="DlibImage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../" class="btn btn-neutral float-left" title="C++ API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, VisionAppster.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-129514554-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>