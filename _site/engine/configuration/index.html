

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Configuration &mdash; VisionAppster  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/algolia.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/docsearch.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/v.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script defer="defer" src="../../_static/js/docsearch.min.js"></script>
        <script defer="defer" src="../../_static/js/algolia.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Graph executor" href="../graph-executor/" />
    <link rel="prev" title="Apps" href="../apps/" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../" class="icon icon-home"> VisionAppster
          

          
            
            <img src="../../_static/v.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Engine</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../#main-elements">Main elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../#supported-platforms">Supported platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apps/">Apps</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#network-interface">Network interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ip-based-access-control">IP-based access control</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cors">CORS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../graph-executor/">Graph executor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hardware-devices/">Hardware devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../management-interface/">Management interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../remote-object-system/">Remote object system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services/">VisionAppster Engine services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../start-stop/">Starting and stopping the Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing-apis/">Testing HTTP APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../web-apps/">Web apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../world-coordinates/">World coordinates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../builder/">Builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/">Built-in tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../components/">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cameras/">Cameras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbook/">Cookbook</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">VisionAppster</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../">Engine</a> &raquo;</li>
        
      <li>Configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">ðŸ”—</a></h1>
<p>The VisionAppster Engine consists of a bunch of software modules that
are available to all apps. The <code class="docutils literal notranslate"><span class="pre">va-engine</span></code> service that runs on the
background is actually a <a class="reference internal" href="../apps/"><span class="doc">VisionAppster app</span></a> itself. It is
started through <code class="docutils literal notranslate"><span class="pre">va-run</span></code> as any app could.</p>
<p>The app is called <code class="docutils literal notranslate"><span class="pre">init.qml</span></code> and stored in the <code class="docutils literal notranslate"><span class="pre">init</span></code> directory
under the VisionAppster installation root. There is also an alternative
app called <code class="docutils literal notranslate"><span class="pre">api-init.qml</span></code> that is intended for running a fixed set of
apps and to publish their APIs. To configure the <code class="docutils literal notranslate"><span class="pre">va-engine</span></code> service,
the easiest way is to modify the <code class="docutils literal notranslate"><span class="pre">init.qml</span></code> script.</p>
<p>The location of the VisionAppster installation and thus the <code class="docutils literal notranslate"><span class="pre">init.qml</span></code>
script varies depending on platform.</p>
<ul class="simple">
<li><p>Windows: <code class="docutils literal notranslate"><span class="pre">C:\Program</span> <span class="pre">Files\VisionAppster\init</span></code></p></li>
<li><p>Generic Linux: <code class="docutils literal notranslate"><span class="pre">/opt/visionappster/init</span></code></p></li>
<li><p>Flatpak: Typing <code class="docutils literal notranslate"><span class="pre">flatpak</span> <span class="pre">info</span> <span class="pre">-l</span> <span class="pre">com.visionappster.Builder</span></code> will
give you the root of the installed Flatpak. The init app can be found
in <code class="docutils literal notranslate"><span class="pre">files/opt/visionappster/init</span></code> under the Flatpak root.</p></li>
</ul>
<p>Since the Engine lets one to install and run new components through the
HTTP interface, it is extremely important to set up access control
correctly. A failure in doing so will easily lead into a remote code
execution vulnerability.</p>
<div class="section" id="network-interface">
<h2>Network interface<a class="headerlink" href="#network-interface" title="Permalink to this headline">ðŸ”—</a></h2>
<p>The default behavior of the <code class="docutils literal notranslate"><span class="pre">init.qml</span></code> app is to bind the web server
to the loopback interface only. This blocks out all external connection
attempts. <code class="docutils literal notranslate"><span class="pre">api-init.qml</span></code> binds to all available interfaces by default.</p>
<p>The web server can be bound to a specific interface or to all available
interfaces. For example:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">127.0.0.1:2015</span></code> - Bind to IPv4 loopback only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[::1]:2015</span></code> - Bind to IPv6 loopback only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0.0.0.0:2015</span></code> - Bind to all IPv4 interfaces.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[::]:2015</span></code> - Bind to all IPv6 interfaces.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">192.168.1.5:2015</span></code> - Bind to a specific IPv4 address.</p></li>
</ul>
<p>The port number (2015) could be anything else, but some client software
may assume the standard port.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// Listen port 2015 on all IPv4 interfaces</span>
<span class="nx">webServer</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="s2">&quot;0.0.0.0:2015&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="ip-based-access-control">
<h2>IP-based access control<a class="headerlink" href="#ip-based-access-control" title="Permalink to this headline">ðŸ”—</a></h2>
<p>The web server supports IP subnet based access control. If no access
control rules have been specified, requests from any IP will be
accepted. Once a single rule has been set up, the default behavior
changes to deny requests. The access control rules work on the TCP
layer, blocking the connection before HTTP has a chance to parse the
request.</p>
<p>The access control mechanism maintains a list of rules that either allow
or deny access based on the clientâ€™s IP address. The first matching rule
will determine the fate of the client. The following example denies
access from a certain evil IP subnet.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// Block evil IPs.</span>
<span class="nx">webServer</span><span class="p">.</span><span class="nx">denyFrom</span><span class="p">(</span><span class="s1">&#39;64.233.160.0/19&#39;</span><span class="p">);</span>
<span class="c1">// An empty address means &quot;everybody&quot;. Allow everybody else.</span>
<span class="nx">webServer</span><span class="p">.</span><span class="nx">allowFrom</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">allowFrom</span></code> and <code class="docutils literal notranslate"><span class="pre">denyFrom</span></code> functions accept IPv4 and IPv6
addresses and subnets. Examples:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">webServer</span><span class="p">.</span><span class="nx">allowFrom</span><span class="p">(</span><span class="s1">&#39;10.0.0.0/255.255.255.0&#39;</span><span class="p">);</span> <span class="c1">// IPv4 address/netmask</span>
<span class="nx">webServer</span><span class="p">.</span><span class="nx">denyFrom</span><span class="p">(</span><span class="s1">&#39;10.0.0.0/24&#39;</span><span class="p">);</span> <span class="c1">// Same in CIDR notation</span>
<span class="nx">webServer</span><span class="p">.</span><span class="nx">allowFrom</span><span class="p">(</span><span class="s1">&#39;10.0.0.1&#39;</span><span class="p">);</span> <span class="c1">// IPv4 host address</span>
<span class="nx">webServer</span><span class="p">.</span><span class="nx">denyFrom</span><span class="p">(</span><span class="s1">&#39;fe80::a65d:36ff:fec8:aced&#39;</span><span class="p">);</span> <span class="c1">// IPv6 host address</span>
<span class="nx">webServer</span><span class="p">.</span><span class="nx">allowFrom</span><span class="p">(</span><span class="s1">&#39;fe80::/64&#39;</span><span class="p">);</span> <span class="c1">// IPv6 subnet</span>
<span class="nx">webServer</span><span class="p">.</span><span class="nx">denyFrom</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="c1">// Any IP address (v4 or v6)</span>
</pre></div>
</div>
</div>
<div class="section" id="cors">
<h2>CORS<a class="headerlink" href="#cors" title="Permalink to this headline">ðŸ”—</a></h2>
<p><a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a> is a
technique implemented by browsers to allow web pages to make requests to
servers they did not originate from. Since this is generally unsafe, the
target server must be explicitly configured to accept the requests.</p>
<p>The Engineâ€™s web server disallows CORS requests by default. That is,
scripts loaded from a web server other than the Engineâ€™s own will not be
able to make requests to it. Note however that this only applies to
browsers. A malicious Node.js script run locally can still make requests
to the server. The <code class="docutils literal notranslate"><span class="pre">api-init.qml</span></code> app does not expose unsafe features
to the web server and therefore enables CORS:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">WebServer</span>
<span class="p">{</span>
  <span class="nx">id</span><span class="o">:</span> <span class="nx">webServer</span>
  <span class="nx">corsEnabled</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This allows CORS requests made by any script independent of its origin.
For a more fine-grained control one can specify which domains are
allowed to make CORS requests:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">WebServer</span>
<span class="p">{</span>
  <span class="nx">id</span><span class="o">:</span> <span class="nx">webServer</span>
  <span class="nx">corsEnabled</span><span class="o">:</span> <span class="kc">true</span>
  <span class="nx">corsOrigins</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;https://doc.visionappster.com&#39;</span><span class="p">,</span> <span class="s1">&#39;http://safe.site:8888&#39;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../graph-executor/" class="btn btn-neutral float-right" title="Graph executor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../apps/" class="btn btn-neutral float-left" title="Apps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, VisionAppster.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-129514554-1', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>